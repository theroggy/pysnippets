from matplotlib import pyplot as plt
from shapely import is_valid_reason, wkt, make_valid
from shapely.plotting import plot_polygon

geometry = wkt.loads(
    "MultiPolygon (((344304.97695937682874501 5481450.38756692595779896, 344099.97695937682874501 5481344.1063362555578351, 344099.97695937682874501 5481344.58168418798595667, 344099.97695937682874501 5481345.53238005191087723, 344099.97695937682874501 5481346.95842384919524193, 344099.97695937682874501 5481348.85981557704508305, 344099.97695937682874501 5481351.23655523825436831, 344099.97695937682874501 5481354.08864283189177513, 344099.97695937682874501 5481357.41607835702598095, 344099.97695937682874501 5481361.21886181458830833, 344099.43008437682874501 5481364.54629733972251415, 344098.33633437682874501 5481367.39838493335992098, 344096.69570937682874501 5481369.77512459456920624, 344094.50820937682874501 5481371.67651632241904736, 344091.77383437682874501 5481373.10256011970341206, 344088.49258437682874501 5481374.05325598455965519, 344084.66445937682874501 5481374.52860391605645418, 344080.28945937682874501 5481374.52860391605645418, 344076.38320937682874501 5481374.84110391605645418, 344072.94570937682874501 5481375.46610391605645418, 344069.97695937682874501 5481376.40360391605645418, 344067.47695937682874501 5481377.65360391605645418, 344065.44570937682874501 5481379.21610391605645418, 344063.88320937682874501 5481381.09110391605645418, 344062.78945937682874501 5481383.27860391605645418, 344062.16445937682874501 5481385.77860391605645418, 344062.63320937682874501 5481389.05985391605645418, 344064.19570937682874501 5481393.12235391605645418, 344066.85195937682874501 5481397.96610391605645418, 344070.60195937682874501 5481403.59110391605645418, 344075.44570937682874501 5481409.99735391605645418, 344081.38320937682874501 5481417.18485391605645418, 344088.41445937682874501 5481425.15360391605645418, 344096.53945937682874501 5481433.90360391605645418, 344104.27383437682874501 5481441.71610391605645418, 344111.61758437682874501 5481448.59110391605645418, 344118.57070937682874501 5481454.52860391605645418, 344125.13320937682874501 5481459.52860391605645418, 344131.30508437682874501 5481463.59110391605645418, 344137.08633437682874501 5481466.71610391605645418, 344142.47695937682874501 5481468.90360391605645418, 344147.47695937682874501 5481470.15360391605645418, 344151.77383437682874501 5481470.85672891605645418, 344155.36758437682874501 5481471.01297891605645418, 344158.25820937682874501 5481470.62235391605645418, 344160.44570937682874501 5481469.68485391605645418, 344161.93008437682874501 5481468.20047891605645418, 344162.71133437682874501 5481466.16922891605645418, 344162.78945937682874501 5481463.59110391605645418, 344162.16445937682874501 5481460.46610391605645418, 344161.89102187682874501 5481457.65360391605645418, 344161.96914687682874501 5481455.15360391605645418, 344162.39883437682874501 5481452.96610391605645418, 344163.18008437682874501 5481451.09110391605645418, 344164.31289687682874501 5481449.52860391605645418, 344165.79727187682874501 5481448.27860391605645418, 344167.63320937682874501 5481447.34110391605645418, 344169.82070937682874501 5481446.71610391605645418, 344172.08633437682874501 5481446.95047891605645418, 344174.43008437682874501 5481448.04422891605645418, 344176.85195937682874501 5481449.99735391605645418, 344179.35195937682874501 5481452.80985391605645418, 344181.93008437682874501 5481456.48172891605645418, 344184.58633437682874501 5481461.01297891605645418, 344187.32070937682874501 5481466.40360391605645418, 344190.13320937682874501 5481472.65360391605645418, 344193.21914687682874501 5481478.27860391605645418, 344196.57852187682874501 5481483.27860391605645418, 344200.21133437682874501 5481487.65360391605645418, 344204.11758437682874501 5481491.40360391605645418, 344208.29727187682874501 5481494.52860391605645418, 344212.75039687682874501 5481497.02860391605645418, 344217.47695937682874501 5481498.90360391605645418, 344222.47695937682874501 5481500.15360391605645418, 344227.86758437682874501 5481500.40140021312981844, 344233.64883437682874501 5481499.64699280727654696, 344239.82070937682874501 5481497.89038169849663973, 344246.38320937682874501 5481495.13156688585877419, 344253.33633437682874501 5481491.37054837122559547, 344260.68008437682874501 5481486.60732615366578102, 344268.41445937682874501 5481480.84190023317933083, 344276.53945937682874501 5481474.07427060883492231, 344283.64883437682874501 5481468.15259468741714954, 344289.74258437682874501 5481463.07687246985733509, 344294.82070937682874501 5481458.84710395522415638, 344298.88320937682874501 5481455.46328914351761341, 344301.93008437682874501 5481452.92542803473770618, 344303.96133437682874501 5481451.2335206288844347, 344304.97695937682874501 5481450.38756692595779896)),((343929.97695937682874501 5481255.37178009375929832, 343795.16297896695323288 5481184.52860391605645418, 343794.69132241082843393 5481184.80204141605645418, 343793.74800929869525135 5481185.34891641605645418, 343792.33303963037906215 5481186.16922891605645418, 343790.44641340599628165 5481187.26297891605645418, 343788.08813062554690987 5481188.63016641605645418, 343785.25819128891453147 5481190.27079141605645418, 343781.95659539627376944 5481192.18485391605645418, 343778.18334294750820845 5481194.37235391605645418, 343774.72549705486744642 5481197.06766641605645418, 343771.58305771823506802 5481200.27079141605645418, 343768.75602493778569624 5481203.98172891605645418, 343766.24439871340291575 5481208.20047891605645418, 343764.04817904508672655 5481212.92704141605645418, 343762.16736593295354396 5481218.16141641605645418, 343760.60195937682874501 5481223.90360391605645418, 343759.35195937682874501 5481230.15360391605645418, 343758.72695937682874501 5481235.85672891605645418, 343758.72695937682874501 5481241.01297891605645418, 343759.35195937682874501 5481245.62235391605645418, 343760.60195937682874501 5481249.68485391605645418, 343762.47695937682874501 5481253.20047891605645418, 343764.97695937682874501 5481256.16922891605645418, 343768.10195937682874501 5481258.59110391605645418, 343771.85195937682874501 5481260.46610391605645418, 343775.71914687682874501 5481263.55204141605645418, 343779.70352187682874501 5481267.84891641605645418, 343783.80508437682874501 5481273.35672891605645418, 343788.02383437682874501 5481280.07547891605645418, 343792.35977187682874501 5481288.00516641605645418, 343796.81289687682874501 5481297.14579141605645418, 343801.38320937682874501 5481307.49735391605645418, 343806.07070937682874501 5481319.05985391605645418, 343810.75820937682874501 5481329.09891641605645418, 343815.44570937682874501 5481337.61454141605645418, 343820.13320937682874501 5481344.60672891605645418, 343824.82070937682874501 5481350.07547891605645418, 343829.50820937682874501 5481354.02079141605645418, 343834.19570937682874501 5481356.44266641605645418, 343838.88320937682874501 5481357.34110391605645418, 343843.57070937682874501 5481356.71610391605645418, 343847.90664687682874501 5481356.48172891605645418, 343851.89102187682874501 5481356.63797891605645418, 343855.52383437682874501 5481357.18485391605645418, 343858.80508437682874501 5481358.12235391605645418, 343861.73477187682874501 5481359.45047891605645418, 343864.31289687682874501 5481361.16922891605645418, 343866.53945937682874501 5481363.27860391605645418, 343868.41445937682874501 5481365.77860391605645418, 343871.85195937682874501 5481368.74735391605645418, 343876.85195937682874501 5481372.18485391605645418, 343883.41445937682874501 5481376.09110391605645418, 343891.53945937682874501 5481380.46610391605645418, 343901.22695937682874501 5481385.30985391605645418, 343912.47695937682874501 5481390.62235391605645418, 343925.28945937682874501 5481396.40360391605645418, 343939.66445937682874501 5481402.65360391605645418, 343952.24258437682874501 5481407.41922891605645418, 343963.02383437682874501 5481410.70047891605645418, 343972.00820937682874501 5481412.49735391605645418, 343979.19570937682874501 5481412.80985391605645418, 343984.58633437682874501 5481411.63797891605645418, 343988.18008437682874501 5481408.98172891605645418, 343989.97695937682874501 5481404.84110391605645418, 343989.97695937682874501 5481399.21610391605645418, 343989.50820937682874501 5481393.90360391605645418, 343988.57070937682874501 5481388.90360391605645418, 343987.16445937682874501 5481384.21610391605645418, 343985.28945937682874501 5481379.84110391605645418, 343982.94570937682874501 5481375.77860391605645418, 343980.13320937682874501 5481372.02860391605645418, 343976.85195937682874501 5481368.59110391605645418, 343973.10195937682874501 5481365.46610391605645418, 343969.82070937682874501 5481362.34110391605645418, 343967.00820937682874501 5481359.21610391605645418, 343964.66445937682874501 5481356.09110391605645418, 343962.78945937682874501 5481352.96610391605645418, 343961.38320937682874501 5481349.84110391605645418, 343960.44570937682874501 5481346.71610391605645418, 343959.97695937682874501 5481343.59110391605645418, 343959.97695937682874501 5481340.46610391605645418, 343960.28945937682874501 5481337.57547891605645418, 343960.91445937682874501 5481334.91922891605645418, 343961.85195937682874501 5481332.49735391605645418, 343963.10195937682874501 5481330.30985391605645418, 343964.66445937682874501 5481328.35672891605645418, 343966.53945937682874501 5481326.63797891605645418, 343968.72695937682874501 5481325.15360391605645418, 343971.22695937682874501 5481323.90360391605645418, 343973.92227187682874501 5481323.43485391605645418, 343976.81289687682874501 5481323.74735391605645418, 343979.89883437682874501 5481324.84110391605645418, 343983.18008437682874501 5481326.71610391605645418, 343986.65664687682874501 5481329.37235391605645418, 343990.32852187682874501 5481332.80985391605645418, 343994.19570937682874501 5481337.02860391605645418, 343998.25820937682874501 5481342.02860391605645418, 344002.39883437682874501 5481346.55985391605645418, 344006.61758437682874501 5481350.62235391605645418, 344010.91445937682874501 5481354.21610391605645418, 344015.28945937682874501 5481357.34110391605645418, 344019.74258437682874501 5481359.99735391605645418, 344024.27383437682874501 5481362.18485391605645418, 344028.88320937682874501 5481363.90360391605645418, 344033.57070937682874501 5481365.15360391605645418, 344037.75039687682874501 5481365.77860391605645418, 344041.42227187682874501 5481365.77860391605645418, 344044.58633437682874501 5481365.15360391605645418, 344047.24258437682874501 5481363.90360391605645418, 344049.39102187682874501 5481362.02860391605645418, 344051.03164687682874501 5481359.52860391605645418, 344052.16445937682874501 5481356.40360391605645418, 344052.78945937682874501 5481352.65360391605645418, 344052.90664687682874501 5481348.85657997615635395, 344052.51602187682874501 5481345.01253209542483091, 344051.61758437682874501 5481341.12146027572453022, 344050.21133437682874501 5481337.18336451519280672, 344048.29727187682874501 5481333.19824481476098299, 344045.87539687682874501 5481329.16610117442905903, 344042.94570937682874501 5481325.08693359326571226, 344039.50820937682874501 5481320.96074207220226526, 344036.50039687682874501 5481317.3503244910389185, 344033.92227187682874501 5481314.25568085163831711, 344031.77383437682874501 5481311.67681115120649338, 344030.05508437682874501 5481309.61371539160609245, 344028.76602187682874501 5481308.06639357097446918, 344027.90664687682874501 5481307.03484569024294615, 344027.47695937682874501 5481306.51907175034284592, 344015.00805627962108701 5481300.05463093891739845, 343972.47695937682874501 5481277.70503498613834381, 343971.93008437682874501 5481278.43665325082838535, 343970.83633437682874501 5481279.89988977927714586, 343969.19570937682874501 5481282.09474457241594791, 343967.00820937682874501 5481285.02121763117611408, 343964.27383437682874501 5481288.67930895462632179, 343960.99258437682874501 5481293.0690185409039259, 343957.16445937682874501 5481298.19034639280289412, 343952.78945937682874501 5481304.04329250939190388, 343948.68789687682874501 5481309.1646203612908721, 343944.85977187682874501 5481313.5543299475684762, 343941.30508437682874501 5481317.21242127008736134, 343938.02383437682874501 5481320.1388943288475275, 343935.01602187682874501 5481322.33374912291765213, 343932.28164687682874501 5481323.79698565229773521, 343929.82070937682874501 5481324.52860391605645418, 343927.63320937682874501 5481324.52860391605645418, 343925.48477187682874501 5481324.17704141605645418, 343923.37539687682874501 5481323.47391641605645418, 343921.30508437682874501 5481322.41922891605645418, 343919.27383437682874501 5481321.01297891605645418, 343917.28164687682874501 5481319.25516641605645418, 343915.32852187682874501 5481317.14579141605645418, 343913.41445937682874501 5481314.68485391605645418, 343911.53945937682874501 5481311.87235391605645418, 343910.28945937682874501 5481308.68240354396402836, 343909.66445937682874501 5481305.11500279977917671, 343909.66445937682874501 5481301.17015168350189924, 343910.28945937682874501 5481296.8478501932695508, 343911.53945937682874501 5481292.14809833280742168, 343913.41445937682874501 5481287.07089609932154417, 343915.91445937682874501 5481281.61624349374324083, 343919.03945937682874501 5481275.78414051607251167, 343921.77383437682874501 5481270.68105041049420834, 343924.11758437682874501 5481266.30697317700833082, 343926.07070937682874501 5481262.66190881654620171, 343927.63320937682874501 5481259.74585732631385326, 343928.80508437682874501 5481257.55881871003657579, 343929.58633437682874501 5481256.10079296585172415, 343929.97695937682874501 5481255.37178009375929832)))"
)
print(f"{geometry.geom_type=}")
print(f"{is_valid_reason(geometry)=}")
plot_polygon(geometry)
# plt.show()

geometry_b = geometry.buffer(0)
print(f"{geometry_b.geom_type=}")
plot_polygon(geometry_b)
# plt.show()

geometry_valid = make_valid(geometry)
print(f"{geometry_valid.geom_type=}")

# to check with the separate polygons
geometry_2 = geometry.geoms[0]
print(f"{geometry_2.buffer(0).is_empty=}")
geometry_3 = geometry.geoms[1]
print(f"{geometry_3.buffer(0).is_empty=}")
