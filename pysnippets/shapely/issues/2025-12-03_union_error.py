import numpy as np
import shapely
from shapely import ops
from shapely.geometry import Polygon

print(f"Shapely version: {shapely.__version__}, geos version: {shapely.geos_version_string}")


polygons = np.array(
    [
        [
            [-9.107924729871753, -49.578770022602505],
            [-11.477396284004609, -55.48211427005445],
            [-8.779906989660152, -68.10055885244654],
            [-9.107924729871753, -49.578770022602505],
        ],
        [
            [-10.944553152533185, -68.40940481609661],
            [-8.779906989660152, -68.10055885244654],
            [-11.477396284004609, -55.48211427005445],
            [-10.944553152533185, -68.40940481609661],
        ],
        [
            [-9.665730626080167, -46.63520657856243],
            [-9.107924729871753, -49.578770022602505],
            [-6.1606394792661385, -39.56368325939373],
            [-9.665730626080167, -46.63520657856243],
        ],
        [
            [-9.107924729871753, -49.578770022602505],
            [-9.665730626080167, -46.63520657856243],
            [-11.477396284004609, -55.48211427005445],
            [-9.107924729871753, -49.578770022602505],
        ],
        [
            [-5.60266871361742, -43.06086475203977],
            [-9.107924729871753, -49.578770022602505],
            [-4.725701460041062, -67.88249984010983],
            [-5.60266871361742, -43.06086475203977],
        ],
        [
            [-8.779906989660152, -68.10055885244654],
            [-4.725701460041062, -67.88249984010983],
            [-9.107924729871753, -49.578770022602505],
            [-8.779906989660152, -68.10055885244654],
        ],
        [
            [-6.1606394792661385, -39.56368325939373],
            [-5.60266871361742, -43.06086475203977],
            [-4.414116785691194, -23.00105208875605],
            [-6.1606394792661385, -39.56368325939373],
        ],
        [
            [-5.60266871361742, -43.06086475203977],
            [-6.1606394792661385, -39.56368325939373],
            [-9.107924729871753, -49.578770022602505],
            [-5.60266871361742, -43.06086475203977],
        ],
        [
            [2.1655564768683804, -59.48149581506282],
            [-1.2937332149450005, -65.40092352724034],
            [-0.47975546014527914, -67.79429254345098],
            [2.1655564768683804, -59.48149581506282],
        ],
        [
            [-4.725701460041062, -67.88249984010983],
            [-0.47975546014527914, -67.79429254345098],
            [-1.2937332149450005, -65.40092352724034],
            [-4.725701460041062, -67.88249984010983],
        ],
        [
            [-2.053526421384758, -39.38388953414288],
            [-5.60266871361742, -43.06086475203977],
            [-1.2937332149450005, -65.40092352724034],
            [-2.053526421384758, -39.38388953414288],
        ],
        [
            [-4.725701460041062, -67.88249984010983],
            [-1.2937332149450005, -65.40092352724034],
            [-5.60266871361742, -43.06086475203977],
            [-4.725701460041062, -67.88249984010983],
        ],
        [
            [-2.053526421384758, -39.38388953414288],
            [2.1655564768683804, -59.48149581506282],
            [2.5949143307751905, -38.432078492985355],
            [-2.053526421384758, -39.38388953414288],
        ],
        [
            [2.1655564768683804, -59.48149581506282],
            [-2.053526421384758, -39.38388953414288],
            [-1.2937332149450005, -65.40092352724034],
            [2.1655564768683804, -59.48149581506282],
        ],
        [
            [2.5949143307751905, -38.432078492985355],
            [4.045017485226917, -44.591813884340915],
            [3.6619129070589773, -17.61026441148638],
            [2.5949143307751905, -38.432078492985355],
        ],
        [
            [4.045017485226917, -44.591813884340915],
            [2.5949143307751905, -38.432078492985355],
            [2.1655564768683804, -59.48149581506282],
            [4.045017485226917, -44.591813884340915],
        ],
        [
            [-3.7536959540663597, -8.859098859659706],
            [-5.923720686905879, -16.235821209122424],
            [-2.053526421384758, -39.38388953414288],
            [-3.7536959540663597, -8.859098859659706],
        ],
        [
            [-5.60266871361742, -43.06086475203977],
            [-2.053526421384758, -39.38388953414288],
            [-5.923720686905879, -16.235821209122424],
            [-5.60266871361742, -43.06086475203977],
        ],
        [
            [-4.04425967854734, -1.346139278400533],
            [-3.7536959540663597, -8.859098859659706],
            [-1.5732562941774, 7.904434391775184],
            [-4.04425967854734, -1.346139278400533],
        ],
        [
            [-3.7536959540663597, -8.859098859659706],
            [-4.04425967854734, -1.346139278400533],
            [-5.923720686905879, -16.235821209122424],
            [-3.7536959540663597, -8.859098859659706],
        ],
        [
            [4.843141390976509, -25.008359188703416],
            [0.4110324192521997, -31.95495216694697],
            [2.5949143307751905, -38.432078492985355],
            [4.843141390976509, -25.008359188703416],
        ],
        [
            [-2.053526421384758, -39.38388953414288],
            [2.5949143307751905, -38.432078492985355],
            [0.4110324192521997, -31.95495216694697],
            [-2.053526421384758, -39.38388953414288],
        ],
        [
            [-2.170090738900679, 1.6419854605789586],
            [-3.7536959540663597, -8.859098859659706],
            [0.4110324192521997, -31.95495216694697],
            [-2.170090738900679, 1.6419854605789586],
        ],
        [
            [-2.053526421384758, -39.38388953414288],
            [0.4110324192521997, -31.95495216694697],
            [-3.7536959540663597, -8.859098859659706],
            [-2.053526421384758, -39.38388953414288],
        ],
        [
            [-1.5732562941774, 7.904434391775184],
            [-2.170090738900679, 1.6419854605789586],
            [2.8024433800252715, 7.181446815562015],
            [-1.5732562941774, 7.904434391775184],
        ],
        [
            [-2.170090738900679, 1.6419854605789586],
            [-1.5732562941774, 7.904434391775184],
            [-3.7536959540663597, -8.859098859659706],
            [-2.170090738900679, 1.6419854605789586],
        ],
        [
            [2.8024433800252715, 7.181446815562015],
            [5.381901308363052, -5.870328981043782],
            [4.681265179678338, 8.397375883356942],
            [2.8024433800252715, 7.181446815562015],
        ],
        [
            [5.381901308363052, -5.870328981043782],
            [2.8024433800252715, 7.181446815562015],
            [4.843141390976509, -25.008359188703416],
            [5.381901308363052, -5.870328981043782],
        ],
        [
            [2.580837628690858, 7.786696889308906],
            [2.8024433800252715, 7.181446815562015],
            [4.681265179678338, 8.397375883356942],
            [2.580837628690858, 7.786696889308906],
        ],
        [
            [2.8024433800252715, 7.181446815562015],
            [2.580837628690858, 7.786696889308906],
            [-1.5732562941774, 7.904434391775184],
            [2.8024433800252715, 7.181446815562015],
        ],
        [
            [-0.6817281672365398, -10.358260061109213],
            [-2.319196218072649, -18.323526770995862],
            [0.6062394536853688, -36.171064870529165],
            [-0.6817281672365398, -10.358260061109213],
        ],
        [
            [-0.8479686316326367, -38.51013375163708],
            [0.6062394536853688, -36.171064870529165],
            [-2.319196218072649, -18.323526770995862],
            [-0.8479686316326367, -38.51013375163708],
        ],
        [
            [-0.6817281672365398, -10.358260061109213],
            [4.566295472788307, -31.108901689146226],
            [3.0243411341241897, -3.518368608349892],
            [-0.6817281672365398, -10.358260061109213],
        ],
        [
            [4.566295472788307, -31.108901689146226],
            [-0.6817281672365398, -10.358260061109213],
            [0.6062394536853688, -36.171064870529165],
            [4.566295472788307, -31.108901689146226],
        ],
        [
            [-2.141304908669232, 18.810314416253544],
            [-4.104516608506552, 12.112119256727777],
            [-0.6817281672365398, -10.358260061109213],
            [-2.141304908669232, 18.810314416253544],
        ],
        [
            [-2.319196218072649, -18.323526770995862],
            [-0.6817281672365398, -10.358260061109213],
            [-4.104516608506552, 12.112119256727777],
            [-2.319196218072649, -18.323526770995862],
        ],
        [
            [-2.141304908669232, 18.810314416253544],
            [3.0243411341241897, -3.518368608349892],
            [1.2563100802122635, 29.327045820015645],
            [-2.141304908669232, 18.810314416253544],
        ],
        [
            [3.0243411341241897, -3.518368608349892],
            [-2.141304908669232, 18.810314416253544],
            [-0.6817281672365398, -10.358260061109213],
            [3.0243411341241897, -3.518368608349892],
        ],
        [
            [-2.1982913417356875, 26.994559772208923],
            [-2.141304908669232, 18.810314416253544],
            [1.2563100802122635, 29.327045820015645],
            [-2.1982913417356875, 26.994559772208923],
        ],
        [
            [-2.141304908669232, 18.810314416253544],
            [-2.1982913417356875, 26.994559772208923],
            [-4.104516608506552, 12.112119256727777],
            [-2.141304908669232, 18.810314416253544],
        ],
        [
            [1.3464458329117068, 33.01070476711907],
            [1.2563100802122635, 29.327045820015645],
            [4.532507979820731, 35.61904346954334],
            [1.3464458329117068, 33.01070476711907],
        ],
        [
            [1.2563100802122635, 29.327045820015645],
            [1.3464458329117068, 33.01070476711907],
            [-2.1982913417356875, 26.994559772208923],
            [1.2563100802122635, 29.327045820015645],
        ],
        [
            [6.776547203732532, 2.2865090915982376],
            [3.0243411341241897, -3.518368608349892],
            [8.143645356366674, -24.8074378190185],
            [6.776547203732532, 2.2865090915982376],
        ],
        [
            [4.566295472788307, -31.108901689146226],
            [8.143645356366674, -24.8074378190185],
            [3.0243411341241897, -3.518368608349892],
            [4.566295472788307, -31.108901689146226],
        ],
        [
            [6.776547203732532, 2.2865090915982376],
            [9.854949279150409, -14.031791236751758],
            [8.051902692875965, 16.1745493529877],
            [6.776547203732532, 2.2865090915982376],
        ],
        [
            [9.854949279150409, -14.031791236751758],
            [6.776547203732532, 2.2865090915982376],
            [8.143645356366674, -24.8074378190185],
            [9.854949279150409, -14.031791236751758],
        ],
        [
            [5.3340444513882135, 30.498982366146663],
            [1.2563100802122635, 29.327045820015645],
            [6.776547203732532, 2.2865090915982376],
            [5.3340444513882135, 30.498982366146663],
        ],
        [
            [3.0243411341241897, -3.518368608349892],
            [6.776547203732532, 2.2865090915982376],
            [1.2563100802122635, 29.327045820015645],
            [3.0243411341241897, -3.518368608349892],
        ],
        [
            [5.3340444513882135, 30.498982366146663],
            [8.051902692875965, 16.1745493529877],
            [6.612777301917237, 36.063185154347444],
            [5.3340444513882135, 30.498982366146663],
        ],
        [
            [8.051902692875965, 16.1745493529877],
            [5.3340444513882135, 30.498982366146663],
            [6.776547203732532, 2.2865090915982376],
            [8.051902692875965, 16.1745493529877],
        ],
        [
            [4.532507979820731, 35.61904346954334],
            [5.3340444513882135, 30.498982366146663],
            [6.612777301917237, 36.063185154347444],
            [4.532507979820731, 35.61904346954334],
        ],
        [
            [5.3340444513882135, 30.498982366146663],
            [4.532507979820731, 35.61904346954334],
            [1.2563100802122635, 29.327045820015645],
            [5.3340444513882135, 30.498982366146663],
        ],
    ]
)

result = ops.unary_union([Polygon(p) for p in polygons])
print(result)
